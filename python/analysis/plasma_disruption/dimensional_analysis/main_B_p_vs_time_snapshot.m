clc; clear all; close all;
t_c = 0.0047;
t = 10^-6/t_c*[0.0 1000.0 2000.0 3000.0 4000.0 5000.0 6000.0 7000.0 7100.0 7200.0 7300.0 7400.0 7500.0 7600.0 7700.0 7800.0 7900.0 8000.0 8100.0 8200.0 8300.0 8400.0 8500.0 8600.0 8700.0 8800.0 8900.0 9000.0 9100.0 9200.0 9300.0 9400.0 9500.0 9600.0 9700.0 9800.0 9900.0 10000.0 10100.0 10200.0 10300.0 10400.0 10500.0 10600.0 10700.0 10800.0 10900.0 11000.0 12000.0 14000.0 16000.0 18000.0 20000.0 25000.0 30000.0 35000.0 40000.0 45000.0]
B_p = [1.20628735198 1.20626523805 1.20707869737 1.20723519238 1.20736376165 1.2074670058 1.20754408138 1.2076028386 1.2076045133 1.19906264524 1.18985071952 1.17935726652 1.16705135857 1.15640845773 1.14651285721 1.13614306957 1.12399623451 1.11301096412 1.09944287811 1.07422581796 1.07311875967 1.07258952018 1.0718700883 1.07111312563 1.07030253938 1.0692695161 1.06811719473 1.06717789214 1.06612563885 1.06515491405 1.06426265249 1.06346590308 1.06257444528 1.06163403839 1.06083846575 1.06013321546 1.05951893339 1.05891609945 1.05854588381 1.05797133085 1.05715785468 1.05456087396 1.0518653267 1.04924188454 1.04573744025 1.04377528768 1.04035437643 1.03769737041 1.01342337526 0.96027791034 0.903749303838 0.854222332346 0.80439838564 0.673229708095 0.503047974139 0.362047947922 0.230237554518 0.127946587997]
clc
i_start = 8;
i_end = length(t)-4;
i_end = length(t)-7;
t_start = t(i_start);
t_stop = t(i_end);
t_all = t(i_start:i_end)-t_start;
B_p_all = B_p(i_start:i_end);
plot(t_all,B_p_all); hold on

t_final = t_stop-t_start;
dt = 10^-5;
N_steps = t_final/dt;
export_frequency = 1*10^4;
EF_lines = (0:export_frequency:N_steps)*dt;
N_exports = length(EF_lines);
B_mean = ones(1,N_exports)*mean(B_p_all);

% t_EF = linspace(t_start,t_stop,N_exports);
plot(EF_lines,B_mean,'ro'); hold on

mesh_size = 100^3;
N_vars = 4+4;
unknowns = mesh_size*N_vars;
mem = unknowns*N_exports;

disp(['N_exports = ' num2str(N_exports)])
disp(['unknowns  = ' num2str(unknowns/10^6) ' million'])
disp(['memory    = ' num2str(mem/10^6)      ' million'])
