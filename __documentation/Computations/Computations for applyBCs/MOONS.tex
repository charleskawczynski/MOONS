\documentclass[11pt]{article}
\usepackage{graphicx}    % needed for including graphics e.g. EPS, PS
\usepackage{epstopdf}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{xspace}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{epsfig}
\usepackage{float}
\usepackage{natbib}
\usepackage{subfigure}
\usepackage{setspace}
\usepackage{tabularx,ragged2e,booktabs,caption}


\setlength{\oddsidemargin}{0.1in}
\setlength{\textwidth}{7.25in}

\setlength{\topmargin}{-1in}     %\topmargin: gap above header
\setlength{\headheight}{0in}     %\headheight: height of header
\setlength{\topskip}{0in}        %\topskip: between header and text
\setlength{\headsep}{0in}        
\setlength{\textheight}{692pt}   %\textheight: height of main text
\setlength{\textwidth}{7.5in}    % \textwidth: width of text
\setlength{\oddsidemargin}{-0.5in}  % \oddsidemargin: odd page left margin
\setlength{\evensidemargin}{0in} %\evensidemargin : even page left margin
\setlength{\parindent}{0.25in}   %\parindent: indentation of paragraphs
\setlength{\parskip}{0pt}        %\parskip: gap between paragraphs
\setlength{\voffset}{0.5in}


% Useful commands:

% \hfill		aligns-right everything right of \hfill

\begin{document}
\doublespacing
\title{Magnetohydrodynamic Object-Oriented Numerical Solver (MOONS)}
\author{C. Kawczynski \\
Department of Mechanical and Aerospace Engineering \\
University of California Los Angeles, USA\\
}
\maketitle

\section{applyBCs for sn less than sc}

This document describes how the applyBCs module works. Succinctly, when called, it defines the ghost values of a field such that the boundary conditions are enforced.

\section{Dirichlet}
For wall coincident Dirichlet BCs, the boundary values themselves are prescribed in addition to the ghost values.

\subsection{Direct (wall coincident)}
Trivial assignment
\begin{equation}
u = u_{bc}
\end{equation}

\subsection{Interpolated (Wall incoincident)}
Ghost values mirror about the boundary value. In order to do this, slopes are matched from the ghost cell to the first interior cell using the prescribed boundary value.

\subsubsection{General}
\begin{equation}
	\frac{u_{ghost}-u_{interior}}{h_{ghost}-h_{interior}}
	=
	\frac{u_{wall}-u_{interior}}{h_{wall}-h_{interior}}
\end{equation}
Solving for the ghost values we have
\begin{equation}
	u_{ghost}
	=
	u_{interior} + \alpha (u_{wall}-u_{interior})
\end{equation}
\begin{equation}
	=
	u_{wall}\alpha + u_{interior}(1-\alpha)
\end{equation}
Where
\begin{equation}
	\alpha = \frac{h_{ghost}-h_{interior}}{h_{wall}-h_{interior}}
\end{equation}

% \subsubsection{Forward}
% \begin{equation}
% \frac{u_{c,1}-u_{c,2}}{h_{c,1}-h_{c,2}} = \frac{u_{wall}-u_{c,2}}{h_{n,1}-h_{c,2}}
% \end{equation}
% Solving for $u_1$ yields
% \begin{equation}
% 	u_{c,1} = u_{c,2} + \frac{h_{c,1}-h_{c,2}}{h_{n,1}-h_{c,2}}(u_{wall}-u_{c,2})
% \end{equation}

% \subsubsection{Backward}
% \begin{equation}
% \frac{u_{c,sc}-u_{c,sc-1}}{h_{c,sc}-h_{c,sc-1}} = \frac{u_{n,sn}-u_{c,sc-1}}{h_{n,sn}-h_{c,sc-1}}
% \end{equation}
% Solving for $u_{sc}$ yields
% \begin{equation}
% 	u_{c,sc} = u_{c,sc-1} + \frac{h_{c,sc}-h_{c,sc-1}}{h_{n,sn}-h_{c,sc-1}}(u_{n,sn}-u_{c,sc-1})
% \end{equation}

\section{Neumann}
% \subsection{Direct (wall coincident) $~O(dh^2)$}
\subsection{Direct (wall coincident) ~O(dh2)}
A 2nd order accurate, one sided difference equation is used to approximate the derivative. The boundary value is then solved for.

\subsection[alternative title goes here]{The values of $\beta$ for which $\omega_i$ is defined at the origin}

\subsubsection{Forward differencing}
Let
\begin{equation}
	\alpha_k = h_{n,2} - h_{n,1} \qquad k = 1
\end{equation}
\begin{equation}
	\beta_j = h_{n,3} - h_{n,1} \qquad j = 2
\end{equation}
And use the one sided difference equation
\begin{equation}
	f_i = \frac{f_i' (\beta_j - \alpha_k) - \frac{\beta_j}{\alpha_k} f_{i+k} + \frac{\alpha_k}{\beta_j} f_{i+j}}{\frac{\alpha_k}{\beta_j} - \frac{\beta_j}{\alpha_k}}
\end{equation}
\subsubsection{Backward differencing}
Let
\begin{equation}
	\alpha_k = -(h_{n,sn} - h_{n,sn-1})  \qquad k = -1
\end{equation}
\begin{equation}
	\beta_j = -(h_{n,sn} - h_{n,sn-2})  \qquad j = -2
\end{equation}
And use the one sided difference equation
\begin{equation}
	f_i = \frac{f_i' (\beta_j - \alpha_k) - \frac{\beta_j}{\alpha_k} f_{i+k} + \frac{\alpha_k}{\beta_j} f_{i+j}}{\frac{\alpha_k}{\beta_j} - \frac{\beta_j}{\alpha_k}}
\end{equation}

\subsection{Direct (wall coincident) ~O(dh)}
These are onee sided, $~O(\Delta h)$, equations. They are probably not the best BCs to use (use $~O(\Delta h^2)$ formulas instead. These equations are simple and should provide a simple check.
\subsubsection{Forward differencing}
\begin{equation}
	\frac{u_{n,1}-u_{n,2}}{h_{n,1}-h_{n,2}} = g
\end{equation}
Where $g$ is the slope at the boundary wall. Solving for $u_{n,1}$ we have
\begin{equation}
	u_{n,1} = u_{n,2} + (h_{n,1}-h_{n,2})g
\end{equation}
\subsubsection{Backward differencing}
\begin{equation}
	\frac{u_{n,sn}-u_{n,sn-1}}{h_{n,sn}-h_{n,sn-1}} = g
\end{equation}
Where $g$ is the slope at the boundary wall. Solving for $u_{n,sn}$ we have
\begin{equation}
	u_{n,sn} = u_{n,sn-1} + (h_{n,sn}-h_{n,sn-1})g
\end{equation}

\subsection{Direct (wall incoincident) ~O(dh2)}
Since the boundary is between 2 incoincident data points, the stencil is symmetric about the boundary and appears simple
\subsubsection{Forward differencing}
\begin{equation}
	\frac{p_1-p_2}{h_{c,1}-h_{c,2}} = p_{wall}'
\end{equation}
\begin{equation}
	p_1 = p_2 + (h_{c,1} - h_{c,2}) p_{wall}'
\end{equation}
\subsubsection{Backward differencing}
\begin{equation}
	\frac{p_{c,sc}-p_{c,sc-1}}{h_{c,sc}-h_{c,sc-1}} = p_{wall}'
\end{equation}
\begin{equation}
	p_{c,sc} = p_{c,sc-1} + (h_{c,sc} - h_{c,sc-1}) p_{wall}'
\end{equation}







\end{document}


